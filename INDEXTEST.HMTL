Gemini

Traduction Morse par Cam√©ra : Complexit√©
Mes contenus
Traducteur Morse Moderne
Traducteur Morse
Gestionnaire de Donn√©es
Traduction Morse par Cam√©ra : Complexit√©
Morse Translator with Visuals
Cr√©ateur de site web Morse
Modifier la largeur de la barre lat√©rale
Transformer un bouton en lien HTML
retiens ce code <!DOCTYPE html> <html lang="fr"> <head>   <meta charset="UTF-8">   <meta name="viewport" content="width=device-width, initial-scale=1.0">   <title>GenCodeBarres v2.2 - WYSIWYG</title>   <meta name="theme-color" content="#0f172a">   <!-- Polices Modernes -->   <link rel="preconnect" href="https://fonts.googleapis.com">   <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>   <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">   <!-- Librairies -->   <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js"></script>   <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode/1.5.1/qrcode.min.js"></script>   <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>   <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>   <style>     :root {        /* Palette Pro SaaS (Slate) */       --bg-app: #0f172a;       /* Fond principal tr√®s sombre */       --bg-sidebar: #1e293b;   /* Sidebar l√©g√®rement plus claire */       --bg-panel: #334155;     /* Fond des inputs */              --border-subtle: #334155;       --border-focus: #3b82f6;       --text-main: #f8fafc;       --text-secondary: #94a3b8;              --primary: #3b82f6;      /* Bleu standard professionnel */       --primary-hover: #2563eb;              --success: #10b981;       --danger: #ef4444;       --radius: 6px;      }     body {        font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;       background-color: var(--bg-app);       color: var(--text-main);        margin: 0; padding: 0;        height: 100vh;        display: flex;        overflow: hidden;      }     /* --- SCROLLBAR --- */     ::-webkit-scrollbar { width: 8px; }     ::-webkit-scrollbar-track { background: var(--bg-app); }     ::-webkit-scrollbar-thumb { background: var(--bg-panel); border-radius: 4px; }     ::-webkit-scrollbar-thumb:hover { background: var(--text-secondary); }     /* --- SIDEBAR --- */     .sidebar {       width: 320px;        background: var(--bg-sidebar);       border-right: 1px solid var(--border-subtle);       padding: 0;        display: flex; flex-direction: column;       z-index: 10;        overflow-y: auto;       box-shadow: 4px 0 24px rgba(0,0,0,0.2);       flex-shrink: 0;     }     .sidebar-header {       padding: 20px 24px;       border-bottom: 1px solid var(--border-subtle);       background: var(--bg-sidebar);       position: sticky; top: 0; z-index: 20;     }     .app-title {       margin: 0;        color: #fff;       font-weight: 600;       font-size: 1rem;       display: flex; align-items: center; gap: 10px;     }     .sidebar-content {       padding: 24px;       display: flex; flex-direction: column; gap: 24px;       flex: 1;      }     /* --- SIDEBAR FOOTER --- */     .sidebar-footer {       padding: 15px 24px;       border-top: 1px solid var(--border-subtle);       text-align: center;       font-size: 0.75rem;       color: var(--text-secondary);       background: var(--bg-sidebar);       margin-top: auto;      }     /* --- ONGLETS --- */     .tabs-nav {       display: flex;       background: #0f172a;       padding: 3px;       border-radius: var(--radius);       border: 1px solid var(--border-subtle);     }     .tab-btn {       flex: 1;        padding: 8px;        background: transparent;        border: none;       color: var(--text-secondary);        cursor: pointer;        font-weight: 500;       font-size: 0.85rem;       border-radius: 4px;        transition: all 0.15s ease;     }     .tab-btn:hover { color: #fff; }     .tab-btn.active {        background: var(--bg-panel);       color: #fff;        box-shadow: 0 1px 2px rgba(0,0,0,0.2);     }     .tab-content { display: none; flex-direction: column; gap: 20px; height: 100%; }     .tab-content.active { display: flex; animation: fadeIn 0.3s ease; }     @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }     /* --- FORMULAIRES --- */     .control-group { display: flex; flex-direction: column; gap: 6px; }          .range-header { display: flex; justify-content: space-between; align-items: center; }     .range-header label, .control-group label {        font-weight: 500; font-size: 0.8rem; color: var(--text-secondary);      }     .range-value {        font-size: 0.75rem; color: var(--text-main); font-family: monospace;        background: var(--bg-app); padding: 2px 6px; border-radius: 3px; border: 1px solid var(--border-subtle);     }     /* Inputs Pro */     input[type="text"], select {        padding: 10px 12px;        border-radius: var(--radius);        border: 1px solid var(--border-subtle);        background: var(--bg-app);        color: #fff;        outline: none;        font-size: 0.9rem;       font-family: inherit;       transition: border-color 0.15s, box-shadow 0.15s;     }     input[type="text"]:focus, select:focus {       border-color: var(--primary);       box-shadow: 0 0 0 1px var(--primary);     }     /* Sliders */     input[type="range"] {       -webkit-appearance: none; width: 100%; background: transparent; cursor: pointer; margin: 8px 0;     }     input[type="range"]::-webkit-slider-runnable-track {       width: 100%; height: 4px; background: var(--bg-panel); border-radius: 2px;     }     input[type="range"]::-webkit-slider-thumb {       -webkit-appearance: none; height: 16px; width: 16px; border-radius: 50%;       background: var(--primary); margin-top: -6px; border: 2px solid var(--bg-sidebar);       transition: transform 0.1s;     }          /* Checkbox & Radio */     .checkbox-wrapper { display: flex; align-items: center; gap: 10px; cursor: pointer; font-size: 0.85rem; user-select: none; color: var(--text-main); }     .checkbox-wrapper input { accent-color: var(--primary); width: 16px; height: 16px; margin: 0; }          .radio-group { display: flex; gap: 1px; background: var(--border-subtle); padding: 1px; border-radius: var(--radius); overflow: hidden; }     .radio-option { flex: 1; position: relative; background: var(--bg-sidebar); }     .radio-option input { position: absolute; opacity: 0; cursor: pointer; height: 100%; width: 100%; z-index: 2; margin: 0; }     .radio-option span {        display: block; text-align: center; padding: 8px;        font-size: 0.8rem; font-weight: 500; cursor: pointer; transition: 0.2s; color: var(--text-secondary);     }     .radio-option input:checked + span { background: var(--primary); color: #fff; }     .divider { border: 0; border-top: 1px solid var(--border-subtle); width: 100%; margin: 5px 0; }     /* --- BOUTONS --- */     .actions { margin-top: auto; display: flex; flex-direction: column; gap: 10px; padding-top: 20px; border-top: 1px solid var(--border-subtle); }     button.action-btn {        padding: 10px; border-radius: var(--radius); border: 1px solid transparent;        font-weight: 500; font-size: 0.9rem; cursor: pointer; transition: all 0.15s;       display: flex; justify-content: center; align-items: center; gap: 8px;     }          .btn-print { background: var(--text-main); color: var(--bg-app); border: 1px solid var(--text-main); }     .btn-print:hover { background: #e2e8f0; }     .btn-download { background: transparent; color: var(--text-main); border: 1px solid var(--border-subtle); }     .btn-download:hover { border-color: var(--text-secondary); background: var(--bg-panel); }     /* Utils btns */     #regenerateBatchBtn { background: var(--primary); color: white; }     #regenerateBatchBtn:hover { background: var(--primary-hover); }          #clearDataBtn { background: rgba(239, 68, 68, 0.1); color: var(--danger); border-color: transparent; }     #clearDataBtn:hover { background: rgba(239, 68, 68, 0.2); }     /* --- IMPORT EXCEL --- */     .drop-zone {       border: 1px dashed var(--border-subtle);       background: var(--bg-app);       border-radius: var(--radius);       padding: 30px 20px;       text-align: center;       color: var(--text-secondary);       cursor: pointer;       transition: all 0.2s;     }     .drop-zone:hover { border-color: var(--primary); color: var(--primary); background: rgba(59, 130, 246, 0.05); }          .status-card {         background: #064e3b;          border: 1px solid #059669;         border-radius: var(--radius);         padding: 12px;         margin-top: 10px;         display: none;      }     /* --- PREVIEW ZONE --- */     .main-content {       flex: 1;        background: #020617;        background-image: radial-gradient(#1e293b 1px, transparent 1px);       background-size: 20px 20px;       display: flex; flex-direction: column;        position: relative;       overflow: hidden; /* Important pour le scroll interne */     }     .toolbar-preview {       position: absolute; top: 15px; left: 50%; transform: translateX(-50%);       background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(4px);       padding: 8px 16px; border-radius: 20px; border: 1px solid var(--border-subtle);       display: flex; align-items: center; gap: 15px; z-index: 50;       color: white; font-size: 0.8rem;     }          /* Scroll wrapper pour centrer la feuille scal√©e */     .preview-scroll-wrapper {       width: 100%; height: 100%;       overflow: auto;       display: flex; justify-content: center; align-items: flex-start;       padding: 80px 40px; /* Padding pour ne pas coller aux bords */       box-sizing: border-box;     }          .sheet-transform-layer {       transform-origin: top center;       transition: transform 0.2s ease-out;       box-shadow: 0 20px 50px rgba(0,0,0,0.5);     }     .sheet {       background: white; color: black;       display: flex; flex-direction: column;        /* Alignement FIXE pour √©viter que le centrage ne bouge quand on ajoute du contenu */       align-items: center; justify-content: flex-start;        position: relative;        box-sizing: border-box;       padding: 10mm; /* Marge interne standard */              /* DIMENSIONS FIXES STRICTES (Blockage) */       overflow: hidden;     }          #canvas-target {        display: flex; justify-content: center; align-items: center; width: 100%; flex: 1;        /* On s'assure que le contenu peut scroller si besoin √† l'int√©rieur mais pas casser la page */     }     #canvas-target.grid-mode { flex-wrap: wrap; align-content: flex-start; gap: 15px; }     .barcode-item { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 5px; }          #title-display {        font-family: 'Arial', sans-serif; font-weight: bold; text-align: center;        width: 100%; word-wrap: break-word; color: #000;       margin-bottom: 20px; /* Espace stable sous le titre */       line-height: 1.2;     }          /* Dimensions Papier Strictes */     /* On utilise HEIGHT et pas MIN-HEIGHT pour bloquer le format */     .sheet.a4.portrait  { width: 210mm; height: 297mm; }      .sheet.a4.landscape { width: 297mm; height: 210mm; }     .sheet.a3.portrait  { width: 297mm; height: 420mm; }     .sheet.a3.landscape { width: 420mm; height: 297mm; }          #barcode-wrapper { width: 100%; display: flex; justify-content: center; height: 100%; }     /* --- IMPRESSION (CORRECTIF MAJEUR) --- */     @media print {       /* Force l'imprimante √† ne pas mettre de marge (le CSS g√®re tout) */       @page { margin: 0; }              body {            background: white;            height: auto;            overflow: visible;           -webkit-print-color-adjust: exact;           print-color-adjust: exact;       }              .sidebar, .toolbar-preview, .sidebar-footer { display: none !important; }              /* Reset total des conteneurs de layout */       .main-content, .preview-scroll-wrapper, .sheet-transform-layer {          position: static !important;          width: auto !important;          height: auto !important;          padding: 0 !important;          margin: 0 !important;          background: transparent !important;          display: block !important;          overflow: visible !important;         transform: none !important; /* CRUCIAL: Annule le zoom √©cran */         box-shadow: none !important;         border: none !important;       }       .sheet {          /* On ne force PAS width:100% ici, on garde les dimensions mm d√©finies par les classes (.a4, etc)            Cela garantit que le layout flexbox interne a exactement le m√™me espace qu'√† l'√©cran. */         margin: 0 !important;          page-break-after: always;          box-shadow: none !important;          border: none !important;         overflow: hidden !important; /* On garde le blocage demand√© */       }              /* S√©curit√© pour le layout grille en impression */       #canvas-target.grid-mode {          display: flex !important;         flex-wrap: wrap !important;         gap: 15px !important;       }              .barcode-item { break-inside: avoid; }     }   </style>   <style id="print-style"></style> </head> <body>   <aside class="sidebar">     <div class="sidebar-header">       <div class="app-title">GenCodeBarre<span style="font-size: 0.7em; opacity: 0.6; font-weight: normal; margin-left: 5px;">v2.2 Wysiwyg</span></div>     </div>          <div class="sidebar-content">       <div class="tabs-nav">         <button class="tab-btn active" id="btn-tab-gen" data-target="tab-generator">√âditeur</button>         <button class="tab-btn" id="btn-tab-tools" data-target="tab-tools">Donn√©es</button>       </div>       <!-- --- ONGLET 1 : G√âN√âRATEUR --- -->       <div id="tab-generator" class="tab-content active">                  <div class="control-group">           <label>Titre de page</label>           <input type="text" id="customTitle" placeholder="Ex: Inventaire 2025">         </div>         <div class="control-group">           <div class="range-header">             <label>Taille Titre</label>             <span id="titleSizeVal" class="range-value">3</span>           </div>           <input type="range" id="titleSizeSlider" min="1" max="10" step="0.5" value="3">         </div>                  <div class="divider"></div>         <div class="control-group">           <label>Donn√©es (Code)</label>           <input type="text" id="texte" value="12345678" placeholder="Saisir le code...">         </div>         <div class="control-group">           <label>Format</label>           <select id="type">             <option value="CODE128" selected>Code 128 (Standard)</option>             <option value="EAN13">EAN-13 (Produit)</option>             <option value="QRCODE">QR Code (Lien)</option>           </select>         </div>         <label class="checkbox-wrapper">           <input type="checkbox" id="showText" checked>           <span>Afficher le texte sous le code</span>         </label>         <div class="divider"></div>         <div class="control-group">           <div class="range-header">             <label>Configuration Papier</label>           </div>           <div class="radio-group">             <label class="radio-option">               <input type="radio" name="format" value="a4" checked>               <span>A4</span>             </label>             <label class="radio-option">               <input type="radio" name="format" value="a3">               <span>A3</span>             </label>             <label class="radio-option" style="border-left: 1px solid var(--border-subtle);">               <input type="radio" name="orientation" value="portrait" checked>               <span>Portrait</span>             </label>             <label class="radio-option">               <input type="radio" name="orientation" value="landscape">               <span>Paysage</span>             </label>           </div>         </div>         <div class="control-group">           <div class="range-header">             <label>√âchelle du Code</label>             <span id="codeSizeVal" class="range-value">1</span>           </div>           <input type="range" id="sizeSlider" min="0.5" max="5" step="0.1" value="1">         </div>         <div class="actions">           <button class="action-btn btn-print" id="printBtn">             Imprimer la page           </button>           <button class="action-btn btn-download" id="downloadBtn">             Sauvegarder en PNG           </button>         </div>       </div>       <!-- --- ONGLET 2 : OUTILS EXCEL --- -->       <div id="tab-tools" class="tab-content">         <div class="control-group">           <label>Import Excel de masse</label>           <label class="drop-zone" id="dropZone">             <div style="font-size: 1.5rem; margin-bottom: 10px;">üìÇ</div>             <div style="font-weight: 500;">S√©lectionner un fichier .xlsx</div>             <div style="font-size: 0.8rem; opacity: 0.6; margin-top: 5px;">Colonne A uniquement</div>             <input type="file" id="excelInput" class="hidden-input" accept=".xlsx, .xls" style="display:none">           </label>         </div>         <!-- Zone de statut -->         <div id="importStatus" class="status-card">           <div style="color: #fff; font-weight: 600; margin-bottom: 5px; font-size: 0.9rem;">              Import termin√©           </div>           <div id="importCount" style="color: #a7f3d0; font-size: 0.85rem;"></div>         </div>         <div class="actions" style="margin-top: auto;">            <button class="action-btn" id="regenerateBatchBtn" style="display:none;">              Voir la planche g√©n√©r√©e            </button>            <button class="action-btn" id="clearDataBtn" style="display:none;">              Effacer les donn√©es            </button>         </div>       </div>     </div>          <div class="sidebar-footer">       <span>Cr√©√© par Micfri</span>     </div>   </aside>   <main class="main-content">          <!-- Barre d'outils flottante pour le Zoom -->     <div class="toolbar-preview">       <span>Zoom Aper√ßu</span>       <input type="range" id="previewZoomSlider" min="0.3" max="1.5" step="0.05" value="0.65" style="width: 100px;">       <span id="previewZoomVal" style="width: 40px; text-align:right;">65%</span>     </div>          <div class="preview-scroll-wrapper">       <div class="sheet-transform-layer" id="sheetLayer">         <div id="pageSheet" class="sheet a4 portrait">           <div id="title-display"></div>           <div id="barcode-wrapper">             <div id="canvas-target"></div>           </div>         </div>       </div>     </div>   </main>   <script>     const refs = {       texte: document.getElementById("texte"),       type: document.getElementById("type"),       showText: document.getElementById("showText"),              slider: document.getElementById("sizeSlider"),       sliderVal: document.getElementById("codeSizeVal"),              target: document.getElementById("canvas-target"),       pageSheet: document.getElementById("pageSheet"),       sheetLayer: document.getElementById("sheetLayer"),       printStyle: document.getElementById("print-style"),       printBtn: document.getElementById("printBtn"),       downloadBtn: document.getElementById("downloadBtn"),       formatInputs: document.querySelectorAll('input[name="format"]'),       orientationInputs: document.querySelectorAll('input[name="orientation"]'),              titleInput: document.getElementById("customTitle"),       titleSizeSlider: document.getElementById("titleSizeSlider"),       titleSizeVal: document.getElementById("titleSizeVal"),       titleDisplay: document.getElementById("title-display"),              // Nouveau Zoom       previewZoomSlider: document.getElementById("previewZoomSlider"),       previewZoomVal: document.getElementById("previewZoomVal"),              tabs: document.querySelectorAll('.tab-btn'),       tabContents: document.querySelectorAll('.tab-content'),       excelInput: document.getElementById("excelInput"),       dropZone: document.getElementById("dropZone"),       importStatus: document.getElementById("importStatus"),       importCount: document.getElementById("importCount"),       clearDataBtn: document.getElementById("clearDataBtn"),       regenerateBatchBtn: document.getElementById("regenerateBatchBtn"),       btnTabGen: document.getElementById("btn-tab-gen")     };     // --- VARIABLES D'√âTAT ---     let appState = {         mode: 'single', // 'single' ou 'batch'         batchData: []   // Stocke les codes import√©s     };     // --- GESTION DU ZOOM APER√áU ---     refs.previewZoomSlider.addEventListener("input", (e) => {       const val = e.target.value;       refs.sheetLayer.style.transform = `scale(${val})`;       refs.previewZoomVal.textContent = Math.round(val * 100) + "%";     });     // --- GESTION DES ONGLETS ---     function switchTab(targetId) {       refs.tabs.forEach(t => {         if(t.getAttribute('data-target') === targetId) t.classList.add('active');         else t.classList.remove('active');       });       refs.tabContents.forEach(c => {         if(c.id === targetId) c.classList.add('active');         else c.classList.remove('active');       });     }     refs.tabs.forEach(tab => tab.addEventListener('click', () => switchTab(tab.getAttribute('data-target'))));     // --- FONCTIONS GENERATEUR ---     function updateTitle() {       refs.titleDisplay.textContent = refs.titleInput.value;       refs.titleDisplay.style.fontSize = refs.titleSizeSlider.value + 'em';       refs.titleSizeVal.textContent = refs.titleSizeSlider.value;     }     function updatePageConfig() {       const format = document.querySelector('input[name="format"]:checked').value;       const orientation = document.querySelector('input[name="orientation"]:checked').value;       refs.pageSheet.className = `sheet ${format} ${orientation}`;       // On ajoute margin:0 dans la regle @page pour l'impression       refs.printStyle.innerHTML = `@page { size: ${format.toUpperCase()} ${orientation}; margin: 0; }`;     }     function generer() {         const scale = parseFloat(refs.slider.value);         refs.sliderVal.textContent = scale;         refs.target.innerHTML = "";         if (appState.mode === 'batch' && appState.batchData.length > 0) {             refs.target.classList.add('grid-mode');             appState.batchData.forEach(code => {                 const itemDiv = document.createElement("div");                 itemDiv.className = "barcode-item";                 const container = createBarcodeElement(code, scale);                 if (container) itemDiv.appendChild(container);                 refs.target.appendChild(itemDiv);             });         } else {             refs.target.classList.remove('grid-mode');             const texte = refs.texte.value.trim();             if (!texte && refs.type.value !== "QRCODE") return;             const element = createBarcodeElement(texte, scale);             if (element) refs.target.appendChild(element);         }     }     function createBarcodeElement(text, scale) {         const type = refs.type.value;         const displayValue = refs.showText.checked;         try {             if (type === "CODE128") {                 const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");                 JsBarcode(svg, text, {                     format: "CODE128", lineColor: "#000", background: "#ffffff",                     displayValue: displayValue, fontSize: 20 * scale, height: 100 * scale,                     width: 2 * scale, margin: 10 * scale                 });                 return svg;             } else if (type === "EAN13") {                 let num = text.replace(/\D/g, "");                 if (num.length === 12) num += calculCheckDigit(num);                 const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");                 JsBarcode(svg, num, {                     format: "EAN13", lineColor: "#000", background: "#ffffff",                     displayValue: displayValue, fontSize: 24 * scale, height: 100 * scale,                     width: 2 * scale, margin: 10 * scale                 });                 return svg;             } else if (type === "QRCODE") {                 const canvas = document.createElement("canvas");                 const qrWidth = Math.floor(300 * scale);                 QRCode.toCanvas(canvas, text || "https://exemple.com", {                     width: qrWidth, margin: 1, color: { dark: "#000000", light: "#ffffff" }                 }, function (error) { if (error) console.error(error); });                 return canvas;             }         } catch (e) {             const errDiv = document.createElement("div");             errDiv.style.color = "red"; errDiv.style.fontSize = "10px"; errDiv.innerText = "Err.";             return errDiv;         }         return null;     }     function calculCheckDigit(ean12) {       let sum = 0;       for (let i = 0; i < 12; i++) sum += (i % 2 === 0 ? 1 : 3) * parseInt(ean12[i]);       const rem = sum % 10;       return rem === 0 ? 0 : 10 - rem;     }     // --- IMPORT EXCEL ---     function handleFile(e) {       const file = e.target.files[0];       if (!file) return;       const reader = new FileReader();       reader.onload = function(e) {         const data = e.target.result;         const workbook = XLSX.read(data, { type: 'binary' });         const firstSheetName = workbook.SheetNames[0];         const worksheet = workbook.Sheets[firstSheetName];         const json = XLSX.utils.sheet_to_json(worksheet, { header: 1 });         let codes = json.map(row => row[0]).filter(cell => cell !== undefined && cell !== null && cell !== "");                  appState.batchData = codes;         appState.mode = 'batch';          updateImportStatus(codes.length);         switchTab('tab-generator');         generer();       };       reader.readAsBinaryString(file);     }     function updateImportStatus(count) {         if(count > 0) {             refs.importStatus.style.display = 'block';             refs.importCount.textContent = `${count} codes import√©s avec succ√®s.`;             refs.regenerateBatchBtn.style.display = 'flex';             refs.clearDataBtn.style.display = 'flex';         } else {             resetImportUI();         }     }     function resetImportUI() {         refs.importStatus.style.display = 'none';         refs.regenerateBatchBtn.style.display = 'none';         refs.clearDataBtn.style.display = 'none';         refs.excelInput.value = "";     }     // --- LISTENERS ---     refs.texte.addEventListener("input", () => { appState.mode = 'single'; generer(); });     refs.type.addEventListener("change", generer);     refs.showText.addEventListener("change", generer);     refs.slider.addEventListener("input", generer);     refs.titleInput.addEventListener("input", updateTitle);     refs.titleSizeSlider.addEventListener("input", updateTitle);     refs.formatInputs.forEach(input => input.addEventListener("change", updatePageConfig));     refs.orientationInputs.forEach(input => input.addEventListener("change", updatePageConfig));     refs.printBtn.addEventListener("click", () => window.print());          refs.downloadBtn.addEventListener("click", () => {         // Pour html2canvas, on enl√®ve temporairement le scale visuel         const originalTransform = refs.sheetLayer.style.transform;         refs.sheetLayer.style.transform = "none";                  // On s'assure de capturer la feuille enti√®re         html2canvas(document.getElementById("pageSheet"), {              scale: 2,              backgroundColor: "#ffffff",              logging: false          })         .then(canvas => {             const a = document.createElement("a");             a.download = `etiquette_${Date.now()}.png`;             a.href = canvas.toDataURL("image/png");             a.click();             // On remet le zoom utilisateur             refs.sheetLayer.style.transform = originalTransform;          });     });     refs.excelInput.addEventListener("change", handleFile);     refs.clearDataBtn.addEventListener("click", () => { appState.batchData = []; appState.mode = 'single'; resetImportUI(); generer(); });     refs.regenerateBatchBtn.addEventListener("click", () => {         if(appState.batchData.length > 0) { appState.mode = 'batch'; switchTab('tab-generator'); generer(); }     });     // Effet Drag & Drop Visuel     const dz = refs.dropZone;     dz.addEventListener('dragover', (e) => { e.preventDefault(); dz.style.borderColor = 'var(--primary)'; dz.style.background = 'rgba(59, 130, 246, 0.1)'; });     dz.addEventListener('dragleave', (e) => { e.preventDefault(); dz.style.borderColor = 'var(--border-subtle)'; dz.style.background = 'var(--bg-app)'; });     dz.addEventListener('drop', (e) => { e.preventDefault(); dz.style.borderColor = 'var(--border-subtle)'; dz.style.background = 'var(--bg-app)';          if(e.dataTransfer.files.length) { refs.excelInput.files = e.dataTransfer.files; handleFile({target: refs.excelInput}); }      });     // Initialisation     window.addEventListener('load', () => {          updatePageConfig();          generer();          updateTitle();         // Set zoom initial         refs.sheetLayer.style.transform = `scale(0.65)`;     });   </script> </body> </html>
Photo Art Effect
Barcode Generator: A Complete Solution
M√©morisation de codes par l'IA
Code Generator App Review
Demande de codes non sp√©cifi√©s
Code G√©n√©rateur Correction et Optimisation
Ajouter signature √† g√©n√©rateur de code
CSS Grid Program Timing Fix
Correction affichage logos M3U
Tesla TV: Lunar Impact Detected
Analyse d'erreur HTML et JavaScript
Id√©es de sites pour Tesla
Cr√©er un site m√©t√©o pour Tesla
Conversation avec Gemini
<!DOCTYPE html>

<html lang="fr">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Traducteur Morse Moderne</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <style>

        /* Configuration de base Tailwind et polices */

        @import url('https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Inter:wght@300;500;700&display=swap');



        body {

            font-family: 'Inter', sans-serif;

            background-color: #0d1117; /* Fond tr√®s sombre */

            color: #c9d1d9; /* Texte clair par d√©faut */

            transition: background-color 0.05s ease;

        }



        /* Styles pour l'effet Lampe Torche (Flash √âcran) */

        body.flash-active {

            background-color: #ffffff !important; /* Blanc total pour le flash */

        }

        

        /* Les √©l√©ments de l'interface doivent s'adapter au mode flash */

        body.flash-active .flash-invert-bg {

            background-color: #f0f6fc !important;

            border-color: #d1d9e6 !important;

            color: #0d1117 !important;

        }

        body.flash-active textarea {

            background-color: #f8fafd !important;

            color: #0d1117 !important;

            border-color: #e2e8f0 !important;

        }



        /* Police sp√©cifique pour les codes et les entr√©es/sorties */

        .mono-code {

            font-family: 'Space Mono', monospace;

        }



        /* Style du bouton d'action */

        .btn-modern {

            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);

            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);

        }

        .btn-modern:hover {

            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.2);

            transform: translateY(-1px);

        }

        .btn-modern:active {

            transform: translateY(0);

            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);

        }



        /* Signal Lumineux (Ampoule) */

        #signal-bulb {

            width: 80px;

            height: 80px;

            border-radius: 50%;

            background: #161b22;

            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);

            transition: all 0.05s ease;

        }

        .signal-active {

            background-color: #00bcd4; /* Cyan/Bleu Vif */

            box-shadow: 0 0 30px 10px rgba(0, 188, 212, 0.9), 0 0 50px 15px rgba(0, 188, 212, 0.5);

        }

        .signal-active #bulb-icon {

            color: #ffffff !important;

            filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.8));

        }



        /* Custom Scrollbar */

        ::-webkit-scrollbar {

            width: 8px;

        }

        ::-webkit-scrollbar-track {

            background: #161b22;

        }

        ::-webkit-scrollbar-thumb {

            background: #30363d;

            border-radius: 4px;

        }

        ::-webkit-scrollbar-thumb:hover {

            background: #484f58;

        }



        /* Champ de texte */

        textarea {

            transition: border-color 0.2s, box-shadow 0.2s;

        }



        /* Responsive adjustments */

        @media (min-width: 1024px) {

            /* Adjust swap button position on desktop */

            #swap-btn {

                left: 50%;

                top: 50%;

                transform: translate(-50%, -50%);

            }

        }

    </style>

</head>

<body class="min-h-screen flex flex-col items-center">



    <!-- Header / Navbar -->

    <header class="w-full bg-[#161b22] border-b border-[#30363d] p-4 sticky top-0 z-50 shadow-lg">

        <div class="max-w-7xl mx-auto flex justify-between items-center">

            <div class="flex items-center space-x-3">

                <i class="fa-solid fa-code-branch text-cyan-400 text-3xl"></i>

                <h1 class="text-2xl font-extrabold text-white tracking-wider">Traducteur <span class="text-cyan-400">Morse</span></h1>

            </div>

            <div class="text-sm text-[#8b949e] font-mono hidden sm:block">

                ... --- ...

            </div>

        </div>

    </header>



    <!-- Main Content -->

    <main class="flex-grow p-4 md:p-8 max-w-7xl w-full">

        

        <!-- Signal Indicator Area -->

        <div class="flex flex-col items-center mb-8">

            <div id="signal-bulb" class="flex items-center justify-center cursor-pointer" title="Indicateur Visuel">

                <i class="fa-solid fa-satellite-dish text-5xl text-[#30363d]" id="bulb-icon"></i>

            </div>

            <div class="text-sm text-cyan-400 font-bold mt-2" id="playing-status">PR√äT</div>

        </div>



        <!-- Translator Area -->

        <div class="grid grid-cols-1 lg:grid-cols-5 gap-6 relative">

            

            <!-- Input Section (2/5 width on large screens) -->

            <div class="lg:col-span-2 bg-[#161b22] rounded-2xl p-6 shadow-2xl border border-[#30363d] flex flex-col h-[450px] flash-invert-bg">

                <div class="flex justify-between items-center mb-4">

                    <label class="text-[#8b949e] font-medium text-sm uppercase tracking-wider flex items-center gap-2">

                        <i class="fa-solid fa-keyboard text-cyan-400"></i> Texte Source

                    </label>

                    <button onclick="clearInput('inputText')" class="text-red-400 hover:text-red-500 text-xs font-bold transition-colors">

                        Effacer

                    </button>

                </div>

                <textarea 

                    id="inputText" 

                    placeholder="Entrez votre message en fran√ßais ici..." 

                    class="w-full flex-grow bg-[#0d1117] text-[#c9d1d9] p-4 rounded-lg focus:ring-2 focus:ring-cyan-500 outline-none resize-none mono-code text-lg border border-[#30363d] placeholder-[#30363d]"

                    oninput="convertToMorse()"

                ></textarea>

                <div class="flex justify-end mt-4 gap-3">

                    <button onclick="pasteText()" class="btn-modern bg-[#30363d] hover:bg-[#484f58] text-white py-2 px-4 rounded-full text-sm flex items-center gap-2">

                        <i class="fa-solid fa-paste"></i> Coller

                    </button>

                    <button onclick="copyToClipboard('inputText', 'Texte Source Copi√© !')" class="btn-modern bg-[#30363d] hover:bg-[#484f58] text-white py-2 px-4 rounded-full text-sm flex items-center gap-2">

                        <i class="fa-solid fa-copy"></i> Copier

                    </button>

                </div>

            </div>



            <!-- Swap Button (Mobile: Hidden, Desktop: Central absolute) -->

            <button id="swap-btn" onclick="swapText()" class="hidden lg:flex absolute bg-cyan-600 hover:bg-cyan-500 text-white w-12 h-12 rounded-full items-center justify-center shadow-xl z-10 btn-modern border-4 border-[#0d1117]" title="Inverser les champs / R√©initialiser">

                <i class="fa-solid fa-arrows-left-right text-lg"></i>

            </button>



            <!-- Output Section (3/5 width on large screens) -->

            <div class="lg:col-span-3 bg-[#161b22] rounded-2xl p-6 shadow-2xl border border-[#30363d] flex flex-col h-[450px] flash-invert-bg">

                <div class="flex justify-between items-center mb-4">

                    <label class="text-[#8b949e] font-medium text-sm uppercase tracking-wider flex items-center gap-2">

                        <i class="fa-solid fa-wave-square text-emerald-400"></i> Code Morse R√©sultat

                    </label>

                    <button onclick="copyToClipboard('outputText', 'Code Morse Copi√© !')" class="text-white bg-emerald-600 hover:bg-emerald-500 py-1.5 px-3 rounded-full text-sm font-bold btn-modern">

                        <i class="fa-solid fa-copy mr-1"></i> Copier Morse

                    </button>

                </div>

                <textarea 

                    id="outputText" 

                    placeholder="Le code Morse traduit appara√Ætra ici..." 

                    class="w-full flex-grow bg-[#0d1117] text-emerald-400 p-4 rounded-lg focus:ring-2 focus:ring-emerald-500 outline-none resize-none mono-code text-xl border border-[#30363d] placeholder-[#30363d] leading-relaxed"

                    oninput="convertToText()"

                ></textarea>

                

                <!-- Controls Grid -->

                <div class="grid grid-cols-4 gap-3 mt-4">

                    <!-- Play / Stop Button -->

                    <div class="col-span-2">

                        <button id="playBtn" onclick="playMorse()" class="btn-modern bg-cyan-600 hover:bg-cyan-500 text-white w-full py-3 rounded-full font-bold flex items-center justify-center gap-2">

                            <i class="fa-solid fa-play"></i> √âcouter le Signal

                        </button>

                        <button id="stopBtn" onclick="stopMorse()" class="btn-modern bg-red-600 hover:bg-red-500 text-white w-full py-3 rounded-full font-bold flex items-center justify-center gap-2 hidden">

                            <i class="fa-solid fa-stop"></i> Arr√™ter

                        </button>

                    </div>



                    <!-- WPM Slider -->

                    <div class="col-span-2 flex flex-col justify-center">

                        <label for="wpm" class="text-xs text-[#8b949e] mb-1">Vitesse (WPM: <span id="wpmValue">20</span>)</label>

                        <input type="range" id="wpm" min="5" max="40" value="20" class="w-full h-2 accent-cyan-500 cursor-pointer rounded-lg bg-[#30363d]">

                    </div>



                    <!-- Lampe Torche √âcran Toggle -->

                    <button id="flashToggleBtn" onclick="toggleFlashlightMode()" class="col-span-2 btn-modern bg-[#30363d] hover:bg-red-500 text-white py-3 rounded-full font-medium flex items-center justify-center gap-2">

                        <i class="fa-solid fa-mobile-screen-button"></i> Flash √âcran : <span id="flashStatus">OFF</span>

                    </button>



                     <!-- Audio Frequency Info -->

                    <div class="col-span-2 flex items-center justify-end text-sm text-[#8b949e] font-mono">

                        <i class="fa-solid fa-volume-high mr-2 text-cyan-400"></i> Freq. Audio: 600 Hz

                    </div>

                </div>

            </div>

        </div>



        <!-- Cheat Sheet (Collapsible & Modern) -->

        <div class="mt-12 bg-[#161b22] rounded-2xl overflow-hidden border border-[#30363d] shadow-xl flash-invert-bg">

            <button onclick="toggleCheatSheet()" class="w-full p-5 flex justify-between items-center text-cyan-400 hover:bg-[#1f2730] transition-colors">

                <span class="font-extrabold text-lg uppercase tracking-wider"><i class="fa-solid fa-book-open-reader mr-3"></i> Dictionnaire du Code Morse</span>

                <i id="chevron" class="fa-solid fa-chevron-down transition-transform text-xl"></i>

            </button>

            <div id="cheatSheet" class="hidden p-6 bg-[#0d1117] border-t border-[#30363d]">

                <div class="grid grid-cols-3 sm:grid-cols-5 md:grid-cols-7 lg:grid-cols-10 gap-3 text-sm mono-code" id="dictionary-grid">

                    <!-- Generated via JS -->

                </div>

            </div>

        </div>



    </main>

    

    <!-- Footer -->

    <footer class="w-full bg-[#161b22] border-t border-[#30363d] p-4 mt-auto">

        <div class="text-center text-[#484f58] text-sm">

            <p>Con√ßu pour une communication d'urgence claire. Le point est l'unit√© de base.</p>

        </div>

    </footer>



    <!-- Toast Notification -->

    <div id="toast" class="fixed bottom-5 right-5 bg-cyan-600 text-white px-6 py-3 rounded-xl shadow-2xl transform translate-y-20 opacity-0 transition-all duration-300 z-50 flex items-center gap-3">

        <i class="fa-solid fa-circle-check text-xl"></i>

        <span id="toast-msg" class="font-medium">Op√©ration r√©ussie</span>

    </div>



    <script>

        // --- DATA (Same as before) ---

        const MORSE_CODE = {

            'A': '.-', 'B': '-...', 'C': '-.-.', 'D': '-..', 'E': '.', 'F': '..-.',

            'G': '--.', 'H': '....', 'I': '..', 'J': '.---', 'K': '-.-', 'L': '.-..',

            'M': '--', 'N': '-.', 'O': '---', 'P': '.--.', 'Q': '--.-', 'R': '.-.',

            'S': '...', 'T': '-', 'U': '..-', 'V': '...-', 'W': '.--', 'X': '-..-',

            'Y': '-.--', 'Z': '--..',

            '1': '.----', '2': '..---', '3': '...--', '4': '....-', '5': '.....',

            '6': '-....', '7': '--...', '8': '---..', '9': '----.', '0': '-----',

            ' ': '/', '.': '.-.-.-', ',': '--..--', '?': '..-..-', "'": '.----.',

            '!': '-.-.--', '/': '-..-.', '(': '-.--.', ')': '-.--.-', '&': '.-...',

            ':': '---...', ';': '-.-.-.', '=': '-...-', '+': '.-.-.', '-': '-....-',

            '_': '..--.-', '"': '.-..-.', '$': '...-..-', '@': '.--.-.'

        };



        const REVERSE_MORSE = Object.fromEntries(Object.entries(MORSE_CODE).map(([k, v]) => [v, k]));



        // --- DOM ELEMENTS ---

        const inputText = document.getElementById('inputText');

        const outputText = document.getElementById('outputText');

        const signalBulb = document.getElementById('signal-bulb');

        const bulbIcon = document.getElementById('bulb-icon');

        const wpmInput = document.getElementById('wpm');

        const wpmValueDisplay = document.getElementById('wpmValue');

        const flashToggleBtn = document.getElementById('flashToggleBtn');

        const flashStatusDisplay = document.getElementById('flashStatus');

        const playingStatusDisplay = document.getElementById('playing-status');



        // --- GLOBAL STATE ---

        let audioCtx = null;

        let isPlaying = false;

        let stopSignal = false;

        let isFlashEnabled = false; // √âtat initial de la lampe torche √©cran

        

        // Fixed frequency value

        const FIXED_FREQUENCY = 600;



        // --- INITIALIZATION ---

        wpmInput.addEventListener('input', () => {

            wpmValueDisplay.textContent = wpmInput.value;

        });



        // Set initial WPM value

        wpmValueDisplay.textContent = wpmInput.value;

        initCheatSheet();





        // --- CONVERSION LOGIC ---

        function convertToMorse() {

            const text = inputText.value.toUpperCase();

            let result = "";

            

            for (let char of text) {

                if (char === '\n') {

                    result += '\n';

                } else if (MORSE_CODE[char]) {

                    result += MORSE_CODE[char] + " ";

                } else if (char === ' ') {

                    result += "/ "; // Slash for word separation

                } else {

                    result += "# "; // Non-traduisible

                }

            }

            outputText.value = result.trim();

        }



        function convertToText() {

            const morse = outputText.value.trim();

            const words = morse.split('/'); // Split by words first

            let result = "";



            words.forEach(word => {

                const chars = word.trim().split(/\s+/); // Split by spaces (letters)

                chars.forEach(char => {

                    if (REVERSE_MORSE[char]) {

                        result += REVERSE_MORSE[char];

                    } else if (char === '') {

                        // ignore empty

                    } else {

                        result += "[?]"; // Indicateur d'erreur

                    }

                });

                result += " ";

            });

            

            inputText.value = result.trim();

        }



        function swapText() {

            inputText.value = "";

            outputText.value = "";

            showToast("Champs de traduction r√©initialis√©s");

        }



        // --- AUDIO/VISUAL ENGINE ---

        async function playMorse() {

            if (isPlaying) return;

            const morse = outputText.value.trim();

            if (!morse) {

                showToast("Veuillez saisir du Code Morse √† jouer !");

                return;

            }



            // Init Audio Context (must be user triggered)

            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();

            if (audioCtx.state === 'suspended') audioCtx.resume();



            isPlaying = true;

            stopSignal = false;

            updatePlayUI(true);



            const wpm = parseInt(wpmInput.value);

            const freq = FIXED_FREQUENCY; // Use fixed frequency

            const unitTime = 1200 / wpm; // Standard formula: T = 1200 / WPM



            for (let i = 0; i < morse.length; i++) {

                if (stopSignal) break;



                const char = morse[i];

                

                // --- Visual/Audio Synchronization ---

                if (char === '.' || char === '-') {

                    const duration = char === '.' ? unitTime : unitTime * 3;

                    

                    toggleSignal(true, char); // Signal ON (visuel/flash + audio)

                    playTone(freq, duration); 

                    await wait(duration);

                    

                    toggleSignal(false); // Signal OFF (visuel/flash)

                    await wait(unitTime); // Gap (1 unit)

                } else if (char === ' ') {

                    // Gap between letters (3 units total, we already waited 1 after the last dot/dash)

                    await wait(unitTime * 2); 

                } else if (char === '/') {

                    // Gap between words (7 units total, we already waited 1 after the last dot/dash)

                    await wait(unitTime * 6);

                }

            }



            isPlaying = false;

            stopSignal = false;

            updatePlayUI(false);

            toggleSignal(false);

        }



        function stopMorse() {

            if (isPlaying) {

                stopSignal = true;

                if(audioCtx) audioCtx.suspend();

                // Reset visual state immediately

                toggleSignal(false); 

                updatePlayUI(false);

                showToast("Signal arr√™t√©");

                // Resume context briefly to allow next play to work if needed

                setTimeout(() => { if(audioCtx) audioCtx.resume(); }, 100);

            }

        }



        function playTone(freq, duration) {

            if (audioCtx.state === 'suspended') audioCtx.resume();

            const osc = audioCtx.createOscillator();

            const gain = audioCtx.createGain();



            osc.type = 'sine';

            osc.frequency.value = freq;

            

            // Smooth attack/release to avoid clicking

            gain.gain.setValueAtTime(0, audioCtx.currentTime);

            gain.gain.linearRampToValueAtTime(0.15, audioCtx.currentTime + 0.01);

            gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + (duration / 1000) - 0.01);



            osc.connect(gain);

            gain.connect(audioCtx.destination);



            osc.start();

            osc.stop(audioCtx.currentTime + (duration / 1000));

        }



        function wait(ms) {

            return new Promise(resolve => setTimeout(resolve, ms));

        }



        // --- FLASH MODE LOGIC ---

        function toggleFlashlightMode() {

            isFlashEnabled = !isFlashEnabled;

            

            if (isFlashEnabled) {

                // Style pour le mode ON

                flashToggleBtn.classList.remove('bg-[#30363d]', 'hover:bg-[#484f58]');

                flashToggleBtn.classList.add('bg-red-600', 'hover:bg-red-500');

                flashStatusDisplay.textContent = "ON";

                showToast("Lampe Torche √âcran : ON");

            } else {

                // Style pour le mode OFF

                flashToggleBtn.classList.add('bg-[#30363d]', 'hover:bg-[#484f58]');

                flashToggleBtn.classList.remove('bg-red-600', 'hover:bg-red-500');

                flashStatusDisplay.textContent = "OFF";

                // Assurez-vous que le corps est r√©initialis√©

                document.body.classList.remove('flash-active');

                showToast("Lampe Torche √âcran : OFF");

            }

        }



        // --- UI HELPERS ---

        function toggleSignal(on, type = null) {

            // 1. Bulb (Internal UI indicator)

            if (on) {

                signalBulb.classList.add('signal-active');

                bulbIcon.classList.add('fa-beat'); // Ajout d'une animation

            } else {

                signalBulb.classList.remove('signal-active');

                bulbIcon.classList.remove('fa-beat');

            }



            // 2. Body Flash (Full-screen effect, only if enabled)

            if (isFlashEnabled) {

                if (on) {

                    document.body.classList.add('flash-active');

                } else {

                    // On laisse un tr√®s court instant de noirceur pour la distinction Dot/Dash

                    setTimeout(() => document.body.classList.remove('flash-active'), 50); 

                }

            }

        }



        function updatePlayUI(playing) {

            const playBtn = document.getElementById('playBtn');

            const stopBtn = document.getElementById('stopBtn');

            

            if (playing) {

                playBtn.classList.add('hidden');

                stopBtn.classList.remove('hidden');

                playingStatusDisplay.textContent = "TRANSMISSION EN COURS...";

                playingStatusDisplay.classList.add('text-red-400', 'animate-pulse');

                

                // D√©sactivation des inputs pendant la lecture

                inputText.disabled = true;

                outputText.disabled = true;

                flashToggleBtn.disabled = true;

                wpmInput.disabled = true;



            } else {

                playBtn.classList.remove('hidden');

                stopBtn.classList.add('hidden');

                playingStatusDisplay.textContent = "PR√äT";

                playingStatusDisplay.classList.remove('text-red-400', 'animate-pulse');

                

                // R√©activation des inputs

                inputText.disabled = false;

                outputText.disabled = false;

                flashToggleBtn.disabled = false;

                wpmInput.disabled = false;

            }

        }



        function clearInput(id) {

            document.getElementById(id).value = '';

            if(id === 'inputText') outputText.value = '';

            if(id === 'outputText') inputText.value = '';

            showToast('Champ effac√©');

        }



        function copyToClipboard(id, message) {

            const copyText = document.getElementById(id);

            copyText.select();

            copyText.setSelectionRange(0, 99999);

            document.execCommand('copy');

            showToast(message);

            

            // Deselect

            if (window.getSelection) {window.getSelection().removeAllRanges();}

        }

        

        async function pasteText() {

            try {

                const text = await navigator.clipboard.readText();

                inputText.value = text;

                convertToMorse();

                showToast("Texte coll√© et traduit");

            } catch (err) {

                showToast("Erreur lors de l'acc√®s au presse-papiers.");

            }

        }



        function showToast(message) {

            const toast = document.getElementById('toast');

            const msg = document.getElementById('toast-msg');

            msg.innerText = message;

            toast.classList.remove('translate-y-20', 'opacity-0');

            toast.classList.add('translate-y-0', 'opacity-100');

            setTimeout(() => {

                toast.classList.remove('translate-y-0', 'opacity-100');

                toast.classList.add('translate-y-20', 'opacity-0');

            }, 2500);

        }



        // --- CHEAT SHEET GENERATION ---

        function toggleCheatSheet() {

            const sheet = document.getElementById('cheatSheet');

            const chevron = document.getElementById('chevron');

            sheet.classList.toggle('hidden');

            if (sheet.classList.contains('hidden')) {

                chevron.classList.remove('rotate-180');

            } else {

                chevron.classList.add('rotate-180');

            }

        }



        function initCheatSheet() {

            const grid = document.getElementById('dictionary-grid');

            Object.entries(MORSE_CODE).forEach(([char, code]) => {

                const div = document.createElement('div');

                div.className = "flex flex-col items-center justify-center bg-[#161b22] p-2.5 rounded-lg border border-[#30363d] hover:bg-[#1f2730] transition-all cursor-pointer flash-invert-bg";

                

                let displayChar = char === ' ' ? 'ESPACE' : char;



                div.innerHTML = `

                    <span class="text-cyan-400 font-bold text-lg">${displayChar}</span> 

                    <span class="text-emerald-400 text-sm tracking-widest mt-1">${code}</span>

                `;

                div.onclick = () => {

                    inputText.value += char;

                    convertToMorse();

                };

                grid.appendChild(div);

            });

        }

    </script>

</body>

</html> IL SERAIT POSSIBLE DE CAPTURE VIA LA CAMERA DES FLASH MORSE ET LES TRADUIRE ,

C'est une excellente id√©e d'√©volution pour le projet !

L'impl√©mentation de la traduction optique du code Morse (capturer des flashs lumineux via la cam√©ra pour les traduire) est techniquement possible, mais elle est significativement plus complexe que la conversion de texte et la lecture audio/visuelle d√©j√† en place.

Voici les √©tapes cl√©s, les d√©fis et une suggestion d'approche pour y parvenir :

üí° Traduction de Flashs Morse par Cam√©ra : Vue d'Ensemble
Pour que votre application puisse "lire" des flashs lumineux, elle devrait :

Acc√©der √† la Cam√©ra : Utiliser l'API MediaDevices (getUserMedia) pour obtenir un flux vid√©o de la cam√©ra.

Analyser le Flux Vid√©o : Traiter chaque image (frame) du flux vid√©o, souvent √† l'aide de l'√©l√©ment canvas.

D√©tecter la Lumi√®re : Identifier des changements significatifs de luminosit√© dans une zone cibl√©e de l'image (l'indicateur lumineux).

D√©terminer les Unit√©s Morse : Mesurer la dur√©e des flashs (points/traits) et des pauses (espaces) pour reconstituer le code Morse.

üõ†Ô∏è D√©fis et Technologies Cl√©s
1. Acc√®s et Performance JavaScript
Aspect	Description
Acc√®s Cam√©ra	N√©cessite l'autorisation de l'utilisateur. En JavaScript, cela se fait via navigator.mediaDevices.getUserMedia({ video: true }).
Analyse en Temps R√©el	L'analyse image par image est tr√®s gourmande en ressources et doit √™tre tr√®s rapide pour fonctionner en temps r√©el. Le code Morse exige des mesures pr√©cises des dur√©es.
D√©tection du Flash	Vous devrez lire les donn√©es de pixels d'une zone centrale de la vid√©o pour calculer une luminosit√© moyenne. Un seuil doit √™tre d√©fini pour distinguer "Flash ON" de "Flash OFF".
2. Algorithme de S√©quencement et de Timing
Le principal d√©fi est de transformer des √©v√©nements de luminosit√© en code Morse, en respectant les r√®gles de synchronisation (bas√©es sur l'unit√© de temps du point, ou dit).

Point (Dit, .): Dur√©e ON de 1 unit√©.

Trait (Dah, -): Dur√©e ON de 3 unit√©s.

Pause entre signaux/symboles (dans une m√™me lettre) : Dur√©e OFF de 1 unit√©.

Pause entre lettres : Dur√©e OFF de 3 unit√©s.

Pause entre mots : Dur√©e OFF de 7 unit√©s (souvent repr√©sent√© par un / ou double espace).

L'algorithme doit s'auto-calibrer en permanence pour estimer la dur√©e de l'unit√© de temps (unitTime) en fonction des signaux re√ßus.

üìù Approche Technique Sug√©r√©e (HTML/JS)
Voici un aper√ßu du code JavaScript n√©cessaire pour l'analyse visuelle, en utilisant un √©l√©ment <video> pour le flux de la cam√©ra et un <canvas> pour l'analyse :

JavaScript
/* --- NOUVEAUX √âL√âMENTS HTML REQUIS --- */
/*
<video id="videoElement" autoplay style="display: none;"></video>
<canvas id="analysisCanvas" style="display: none;"></canvas>
*/

// --- CODE JAVASCRIPT ---

let stream = null;
const videoElement = document.getElementById('videoElement');
const canvas = document.getElementById('analysisCanvas');
const ctx = canvas.getContext('2d');
let lastLightState = false; // true = light, false = dark
let lastEventTime = Date.now();
let morseSequence = '';
let unitDurationEstimate = 100; // Estimation initiale en millisecondes

async function startCameraAnalysis() {
    try {
        // 1. Acc√®s √† la cam√©ra
        stream = await navigator.mediaDevices.getUserMedia({ video: true });
        videoElement.srcObject = stream;
        videoElement.play();

        videoElement.addEventListener('loadeddata', () => {
            canvas.width = videoElement.videoWidth;
            canvas.height = videoElement.videoHeight;
            // D√©marrer la boucle d'analyse de l'image
            requestAnimationFrame(analyzeFrame);
            showToast("Cam√©ra d√©marr√©e pour l'analyse Morse.");
        });

    } catch (err) {
        console.error("Erreur d'acc√®s √† la cam√©ra:", err);
        showToast("Impossible d'acc√©der √† la cam√©ra.");
    }
}

function stopCameraAnalysis() {
    if (stream) {
        stream.getTracks().forEach(track => track.stop());
        stream = null;
    }
    // Ajoutez ici la logique pour arr√™ter requestAnimationFrame si n√©cessaire
}

function analyzeFrame() {
    if (!stream) return;

    // 2. Dessiner la frame sur le canvas
    ctx.drawImage(videoElement, 0, 0, canvas.width, canvas.height);

    // 3. Lire les donn√©es de pixels pour la luminosit√© (ex: zone centrale)
    // Coordonn√©es pour un petit carr√© central (10x10 pixels pour la vitesse)
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;
    const imageData = ctx.getImageData(centerX - 5, centerY - 5, 10, 10).data;
    let totalBrightness = 0;

    // Calculer la luminosit√© moyenne (R+G+B)
    for (let i = 0; i < imageData.length; i += 4) {
        totalBrightness += imageData[i] + imageData[i + 1] + imageData[i + 2];
    }
    const averageBrightness = totalBrightness / (imageData.length * 0.75); // 0.75 pour R+G+B sur 4

    // 4. D√©terminer l'√©tat du flash
    const brightnessThreshold = 150; // Ce seuil doit √™tre calibr√©
    const currentLightState = averageBrightness > brightnessThreshold;

    const currentTime = Date.now();
    const duration = currentTime - lastEventTime;

    if (currentLightState !== lastLightState) {
        // Changement d'√©tat (ON -> OFF ou OFF -> ON)
        
        if (lastLightState) {
            // √âv√©nement de fin de Flash (Light ON -> Light OFF)
            // La 'duration' repr√©sente le Point (.) ou le Trait (-)
            processFlashDuration(duration);
        } else {
            // √âv√©nement de fin de Pause (Light OFF -> Light ON)
            // La 'duration' repr√©sente l'espace entre signaux/lettres/mots
            processSpaceDuration(duration);
        }

        lastLightState = currentLightState;
        lastEventTime = currentTime;
    }

    // Boucle continue
    requestAnimationFrame(analyzeFrame);
}

function processFlashDuration(duration) {
    // 5. D√©terminer si c'est un point ou un trait
    const ratio = duration / unitDurationEstimate;
    let morseSymbol = '#'; // Par d√©faut : Inconnu

    if (ratio >= 0.5 && ratio < 2) {
        morseSymbol = '.'; // Point
    } else if (ratio >= 2 && ratio < 5) {
        morseSymbol = '-'; // Trait
    } else {
        // Signal trop court ou trop long
    }

    morseSequence += morseSymbol;
    // Mettre √† jour unitDurationEstimate (logique d'auto-calibrage)
    // ...
    // Mise √† jour de outputText.value
}

function processSpaceDuration(duration) {
    // 5. D√©terminer si c'est un espace entre signaux, lettres ou mots
    // Logique similaire bas√©e sur le ratio duration / unitDurationEstimate
    // Ajouter " " ou "/" √† la morseSequence
    // ...
}

// Fonction utilitaire pour la traduction de la s√©quence Morse accumul√©e
// ... (Utilisez votre fonction convertToText existante)
Conclusion : L'ajout de cette fonctionnalit√© rendrait l'outil beaucoup plus puissant et interactif, mais n√©cessiterait une phase de d√©veloppement et de calibration importante pour que l'algorithme de d√©tection soit robuste face aux variations de lumi√®re ambiante, de distance de la cam√©ra et de la qualit√© du flash.

Voulez-vous que je vous donne plus de d√©tails sur l'int√©gration des √©l√©ments HTML et le d√©clenchement des fonctions startCameraAnalysis et stopCameraAnalysis dans l'interface existante ?

IL EST POSSIBLE QUE TU ME FASSE UN CODE COMPLET ,

Absolument ! Voici le code HTML/CSS/JavaScript complet int√©grant l'interface et la logique n√©cessaire pour la fonctionnalit√© d'analyse visuelle des flashs Morse par la cam√©ra, en plus des fonctionnalit√©s de traduction et de lecture audio existantes.

J'ai ajout√© deux √©l√©ments HTML masqu√©s (<video> et <canvas>) et une section de contr√¥le d√©di√©e pour la cam√©ra.

üóÑÔ∏è Code Complet du Traducteur Morse (avec Cam√©ra)
HTML
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Traducteur Morse Optique & Audio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Configuration de base Tailwind et polices */
        @import url('https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Inter:wght@300;500;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117; /* Fond tr√®s sombre */
            color: #c9d1d9; /* Texte clair par d√©faut */
            transition: background-color 0.05s ease;
        }

        /* Styles pour l'effet Lampe Torche (Flash √âcran) */
        body.flash-active {
            background-color: #ffffff !important; /* Blanc total pour le flash */
        }
        
        /* Les √©l√©ments de l'interface doivent s'adapter au mode flash */
        body.flash-active .flash-invert-bg {
            background-color: #f0f6fc !important;
            border-color: #d1d9e6 !important;
            color: #0d1117 !important;
        }
        body.flash-active textarea {
            background-color: #f8fafd !important;
            color: #0d1117 !important;
            border-color: #e2e8f0 !important;
        }

        /* Police sp√©cifique pour les codes et les entr√©es/sorties */
        .mono-code {
            font-family: 'Space Mono', monospace;
        }

        /* Style du bouton d'action */
        .btn-modern {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .btn-modern:hover {
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.2);
            transform: translateY(-1px);
        }
        .btn-modern:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* Signal Lumineux (Ampoule) */
        #signal-bulb {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #161b22;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            transition: all 0.05s ease;
        }
        .signal-active {
            background-color: #00bcd4; /* Cyan/Bleu Vif */
            box-shadow: 0 0 30px 10px rgba(0, 188, 212, 0.9), 0 0 50px 15px rgba(0, 188, 212, 0.5);
        }
        .signal-active #bulb-icon {
            color: #ffffff !important;
            filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.8));
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #161b22;
        }
        ::-webkit-scrollbar-thumb {
            background: #30363d;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #484f58;
        }

        /* Champ de texte */
        textarea {
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        /* Responsive adjustments */
        @media (min-width: 1024px) {
            /* Adjust swap button position on desktop */
            #swap-btn {
                left: 50%;
                top: 50%;
                transform: translate(-50%, -50%);
            }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center">

    <header class="w-full bg-[#161b22] border-b border-[#30363d] p-4 sticky top-0 z-50 shadow-lg">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <i class="fa-solid fa-code-branch text-cyan-400 text-3xl"></i>
                <h1 class="text-2xl font-extrabold text-white tracking-wider">Traducteur <span class="text-cyan-400">Morse Optique</span></h1>
            </div>
            <div class="text-sm text-[#8b949e] font-mono hidden sm:block">
                ... --- ...
            </div>
        </div>
    </header>

    <main class="flex-grow p-4 md:p-8 max-w-7xl w-full">
        
        <div class="flex flex-col items-center mb-8">
            <div id="signal-bulb" class="flex items-center justify-center cursor-pointer" title="Indicateur Visuel">
                <i class="fa-solid fa-satellite-dish text-5xl text-[#30363d]" id="bulb-icon"></i>
            </div>
            <div class="text-sm text-cyan-400 font-bold mt-2" id="playing-status">PR√äT</div>
        </div>

        <video id="videoElement" autoplay muted style="display: none;"></video>
        <canvas id="analysisCanvas" style="display: none;"></canvas>

        <div class="grid grid-cols-1 lg:grid-cols-5 gap-6 relative">
            
            <div class="lg:col-span-2 bg-[#161b22] rounded-2xl p-6 shadow-2xl border border-[#30363d] flex flex-col h-[450px] flash-invert-bg">
                <div class="flex justify-between items-center mb-4">
                    <label class="text-[#8b949e] font-medium text-sm uppercase tracking-wider flex items-center gap-2">
                        <i class="fa-solid fa-keyboard text-cyan-400"></i> Texte Source
                    </label>
                    <button onclick="clearInput('inputText')" class="text-red-400 hover:text-red-500 text-xs font-bold transition-colors">
                        Effacer
                    </button>
                </div>
                <textarea 
                    id="inputText" 
                    placeholder="Entrez votre message en fran√ßais ici..." 
                    class="w-full flex-grow bg-[#0d1117] text-[#c9d1d9] p-4 rounded-lg focus:ring-2 focus:ring-cyan-500 outline-none resize-none mono-code text-lg border border-[#30363d] placeholder-[#30363d]"
                    oninput="convertToMorse()"
                ></textarea>
                <div class="flex justify-end mt-4 gap-3">
                    <button onclick="pasteText()" class="btn-modern bg-[#30363d] hover:bg-[#484f58] text-white py-2 px-4 rounded-full text-sm flex items-center gap-2">
                        <i class="fa-solid fa-paste"></i> Coller
                    </button>
                    <button onclick="copyToClipboard('inputText', 'Texte Source Copi√© !')" class="btn-modern bg-[#30363d] hover:bg-[#484f58] text-white py-2 px-4 rounded-full text-sm flex items-center gap-2">
                        <i class="fa-solid fa-copy"></i> Copier
                    </button>
                </div>
            </div>

            <button id="swap-btn" onclick="swapText()" class="hidden lg:flex absolute bg-cyan-600 hover:bg-cyan-500 text-white w-12 h-12 rounded-full items-center justify-center shadow-xl z-10 btn-modern border-4 border-[#0d1117]" title="Inverser les champs / R√©initialiser">
                <i class="fa-solid fa-arrows-left-right text-lg"></i>
            </button>

            <div class="lg:col-span-3 bg-[#161b22] rounded-2xl p-6 shadow-2xl border border-[#30363d] flex flex-col h-[450px] flash-invert-bg">
                <div class="flex justify-between items-center mb-4">
                    <label class="text-[#8b949e] font-medium text-sm uppercase tracking-wider flex items-center gap-2">
                        <i class="fa-solid fa-wave-square text-emerald-400"></i> Code Morse R√©sultat
                    </label>
                    <button onclick="copyToClipboard('outputText', 'Code Morse Copi√© !')" class="text-white bg-emerald-600 hover:bg-emerald-500 py-1.5 px-3 rounded-full text-sm font-bold btn-modern">
                        <i class="fa-solid fa-copy mr-1"></i> Copier Morse
                    </button>
                </div>
                <textarea 
                    id="outputText" 
                    placeholder="Le code Morse traduit appara√Ætra ici..." 
                    class="w-full flex-grow bg-[#0d1117] text-emerald-400 p-4 rounded-lg focus:ring-2 focus:ring-emerald-500 outline-none resize-none mono-code text-xl border border-[#30363d] placeholder-[#30363d] leading-relaxed"
                    oninput="convertToText()"
                ></textarea>
                
                <div class="grid grid-cols-4 gap-3 mt-4">
                    <div class="col-span-2">
                        <button id="playBtn" onclick="playMorse()" class="btn-modern bg-cyan-600 hover:bg-cyan-500 text-white w-full py-3 rounded-full font-bold flex items-center justify-center gap-2">
                            <i class="fa-solid fa-play"></i> √âcouter le Signal
                        </button>
                        <button id="stopBtn" onclick="stopMorse()" class="btn-modern bg-red-600 hover:bg-red-500 text-white w-full py-3 rounded-full font-bold flex items-center justify-center gap-2 hidden">
                            <i class="fa-solid fa-stop"></i> Arr√™ter √âmission
                        </button>
                    </div>

                    <div class="col-span-2 flex flex-col justify-center">
                        <label for="wpm" class="text-xs text-[#8b949e] mb-1">Vitesse (WPM: <span id="wpmValue">20</span>)</label>
                        <input type="range" id="wpm" min="5" max="40" value="20" class="w-full h-2 accent-cyan-500 cursor-pointer rounded-lg bg-[#30363d]">
                    </div>
                    
                    <button id="flashToggleBtn" onclick="toggleFlashlightMode()" class="col-span-2 btn-modern bg-[#30363d] hover:bg-[#484f58] text-white py-3 rounded-full font-medium flex items-center justify-center gap-2">
                        <i class="fa-solid fa-mobile-screen-button"></i> Flash √âcran : <span id="flashStatus">OFF</span>
                    </button>
                    
                    <div class="col-span-2">
                        <button id="cameraStartBtn" onclick="toggleCameraAnalysis()" class="btn-modern bg-emerald-600 hover:bg-emerald-500 text-white w-full py-3 rounded-full font-bold flex items-center justify-center gap-2">
                            <i class="fa-solid fa-video"></i> D√©marrer Cam√©ra
                        </button>
                        <button id="cameraStopBtn" onclick="toggleCameraAnalysis()" class="btn-modern bg-red-600 hover:bg-red-500 text-white w-full py-3 rounded-full font-bold flex items-center justify-center gap-2 hidden">
                            <i class="fa-solid fa-video-slash"></i> Arr√™ter Cam√©ra
                        </button>
                    </div>

                    <div class="col-span-4 flex items-center justify-end text-sm text-[#8b949e] font-mono mt-2">
                        <i class="fa-solid fa-volume-high mr-2 text-cyan-400"></i> Freq. Audio: 600 Hz | <i class="fa-solid fa-lightbulb ml-3 mr-2 text-emerald-400"></i> Calibrage: <span id="unitDurationDisplay">100</span>ms
                    </div>
                </div>
            </div>
        </div>

        <div class="mt-12 bg-[#161b22] rounded-2xl overflow-hidden border border-[#30363d] shadow-xl flash-invert-bg">
            <button onclick="toggleCheatSheet()" class="w-full p-5 flex justify-between items-center text-cyan-400 hover:bg-[#1f2730] transition-colors">
                <span class="font-extrabold text-lg uppercase tracking-wider"><i class="fa-solid fa-book-open-reader mr-3"></i> Dictionnaire du Code Morse</span>
                <i id="chevron" class="fa-solid fa-chevron-down transition-transform text-xl"></i>
            </button>
            <div id="cheatSheet" class="hidden p-6 bg-[#0d1117] border-t border-[#30363d]">
                <div class="grid grid-cols-3 sm:grid-cols-5 md:grid-cols-7 lg:grid-cols-10 gap-3 text-sm mono-code" id="dictionary-grid">
                    </div>
            </div>
        </div>

    </main>
    
    <footer class="w-full bg-[#161b22] border-t border-[#30363d] p-4 mt-auto">
        <div class="text-center text-[#484f58] text-sm">
            <p>Con√ßu pour une communication d'urgence claire. Le point est l'unit√© de base.</p>
        </div>
    </footer>

    <div id="toast" class="fixed bottom-5 right-5 bg-cyan-600 text-white px-6 py-3 rounded-xl shadow-2xl transform translate-y-20 opacity-0 transition-all duration-300 z-50 flex items-center gap-3">
        <i class="fa-solid fa-circle-check text-xl"></i>
        <span id="toast-msg" class="font-medium">Op√©ration r√©ussie</span>
    </div>

    <script>
        // --- DATA ---
        const MORSE_CODE = {
            'A': '.-', 'B': '-...', 'C': '-.-.', 'D': '-..', 'E': '.', 'F': '..-.',
            'G': '--.', 'H': '....', 'I': '..', 'J': '.---', 'K': '-.-', 'L': '.-..',
            'M': '--', 'N': '-.', 'O': '---', 'P': '.--.', 'Q': '--.-', 'R': '.-.',
            'S': '...', 'T': '-', 'U': '..-', 'V': '...-', 'W': '.--', 'X': '-..-',
            'Y': '-.--', 'Z': '--..',
            '1': '.----', '2': '..---', '3': '...--', '4': '....-', '5': '.....',
            '6': '-....', '7': '--...', '8': '---..', '9': '----.', '0': '-----',
            ' ': '/', '.': '.-.-.-', ',': '--..--', '?': '..-..-', "'": '.----.',
            '!': '-.-.--', '/': '-..-.', '(': '-.--.', ')': '-.--.-', '&': '.-...',
            ':': '---...', ';': '-.-.-.', '=': '-...-', '+': '.-.-.', '-': '-....-',
            '_': '..--.-', '"': '.-..-.', '$': '...-..-', '@': '.--.-.'
        };

        const REVERSE_MORSE = Object.fromEntries(Object.entries(MORSE_CODE).map(([k, v]) => [v, k]));

        // --- DOM ELEMENTS ---
        const inputText = document.getElementById('inputText');
        const outputText = document.getElementById('outputText');
        const signalBulb = document.getElementById('signal-bulb');
        const bulbIcon = document.getElementById('bulb-icon');
        const wpmInput = document.getElementById('wpm');
        const wpmValueDisplay = document.getElementById('wpmValue');
        const flashToggleBtn = document.getElementById('flashToggleBtn');
        const flashStatusDisplay = document.getElementById('flashStatus');
        const playingStatusDisplay = document.getElementById('playing-status');
        const unitDurationDisplay = document.getElementById('unitDurationDisplay'); // Nouveau
        const cameraStartBtn = document.getElementById('cameraStartBtn');
        const cameraStopBtn = document.getElementById('cameraStopBtn');

        // --- GLOBAL STATE (Audio/Visual Playback) ---
        let audioCtx = null;
        let isPlaying = false;
        let stopSignal = false;
        let isFlashEnabled = false;
        const FIXED_FREQUENCY = 600;

        // --- GLOBAL STATE (Camera Analysis) ---
        const videoElement = document.getElementById('videoElement');
        const canvas = document.getElementById('analysisCanvas');
        const ctx = canvas.getContext('2d');
        let cameraStream = null;
        let analysisLoop = null; // Pour requestAnimationFrame
        let isCameraActive = false;

        let lastLightState = false; // true = Flash ON, false = Flash OFF
        let lastEventTime = Date.now();
        let morseSequence = '';
        let unitDurationEstimate = 100; // Unit√© de temps (Dit) en ms
        const BRIGHTNESS_THRESHOLD = 150; // Seuil de luminosit√© pour d√©tecter le flash
        const MAX_WPM_FOR_CALIBRATION = 40; // Limite la vitesse d'analyse pour √©viter les erreurs
        const MIN_WPM_FOR_CALIBRATION = 5;

        // --- INITIALIZATION ---
        wpmInput.addEventListener('input', () => {
            wpmValueDisplay.textContent = wpmInput.value;
        });

        wpmValueDisplay.textContent = wpmInput.value;
        initCheatSheet();


        // --- CONVERSION LOGIC ---
        function convertToMorse() {
            const text = inputText.value.toUpperCase();
            let result = "";
            
            for (let char of text) {
                if (char === '\n') {
                    result += '\n';
                } else if (MORSE_CODE[char]) {
                    result += MORSE_CODE[char] + " ";
                } else if (char === ' ') {
                    result += "/ "; // Slash for word separation
                } else {
                    result += "# "; // Non-traduisible
                }
            }
            outputText.value = result.trim();
        }

        function convertToText() {
            const morse = outputText.value.trim();
            const words = morse.split('/'); // Split by words first
            let result = "";

            words.forEach((word, wordIndex) => {
                const chars = word.trim().split(/\s+/); // Split by spaces (letters)
                chars.forEach(char => {
                    if (REVERSE_MORSE[char]) {
                        result += REVERSE_MORSE[char];
                    } else if (char === '') {
                        // ignore empty
                    } else {
                        result += "[?]"; // Indicateur d'erreur
                    }
                });
                if (wordIndex < words.length - 1) {
                    result += " ";
                }
            });
            
            inputText.value = result.trim();
        }

        function swapText() {
            inputText.value = "";
            outputText.value = "";
            morseSequence = ''; // R√©initialiser la s√©quence optique
            showToast("Champs de traduction r√©initialis√©s");
        }
        
        // --- AUDIO/VISUAL PLAYBACK ENGINE ---
        // (Les fonctions playMorse, stopMorse, playTone et wait restent inchang√©es)

        async function playMorse() {
            if (isPlaying) return;
            const morse = outputText.value.trim();
            if (!morse) {
                showToast("Veuillez saisir du Code Morse √† jouer !");
                return;
            }

            // Init Audio Context
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            if (audioCtx.state === 'suspended') audioCtx.resume();

            isPlaying = true;
            stopSignal = false;
            updatePlayUI(true);

            const wpm = parseInt(wpmInput.value);
            const freq = FIXED_FREQUENCY;
            const unitTime = 1200 / wpm; // T = 1200 / WPM

            for (let i = 0; i < morse.length; i++) {
                if (stopSignal) break;

                const char = morse[i];
                
                // --- Visual/Audio Synchronization ---
                if (char === '.' || char === '-') {
                    const duration = char === '.' ? unitTime : unitTime * 3;
                    
                    toggleSignal(true, char); // Signal ON (visuel/flash + audio)
                    playTone(freq, duration); 
                    await wait(duration);
                    
                    toggleSignal(false); // Signal OFF (visuel/flash)
                    await wait(unitTime); // Gap (1 unit)
                } else if (char === ' ') {
                    // Gap between letters (3 units total, we already waited 1 after the last dot/dash)
                    await wait(unitTime * 2); 
                } else if (char === '/') {
                    // Gap between words (7 units total, we already waited 1 after the last dot/dash)
                    await wait(unitTime * 6);
                }
            }

            isPlaying = false;
            stopSignal = false;
            updatePlayUI(false);
            toggleSignal(false);
        }

        function stopMorse() {
            if (isPlaying) {
                stopSignal = true;
                if(audioCtx) audioCtx.suspend();
                toggleSignal(false); 
                updatePlayUI(false);
                showToast("Signal arr√™t√©");
                setTimeout(() => { if(audioCtx) audioCtx.resume(); }, 100);
            }
        }

        function playTone(freq, duration) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();

            osc.type = 'sine';
            osc.frequency.value = freq;
            
            // Smooth attack/release to avoid clicking
            gain.gain.setValueAtTime(0, audioCtx.currentTime);
            gain.gain.linearRampToValueAtTime(0.15, audioCtx.currentTime + 0.01);
            gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + (duration / 1000) - 0.01);

            osc.connect(gain);
            gain.connect(audioCtx.destination);

            osc.start();
            osc.stop(audioCtx.currentTime + (duration / 1000));
        }

        function wait(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // --- CAMERA ANALYSIS LOGIC (Nouveau) ---

        function toggleCameraAnalysis() {
            if (isCameraActive) {
                stopCameraAnalysis();
            } else {
                startCameraAnalysis();
            }
        }

        async function startCameraAnalysis() {
            if (isCameraActive) return;

            try {
                // 1. Acc√®s √† la cam√©ra
                cameraStream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: "environment" } // Pr√©f√®re la cam√©ra arri√®re sur mobile
                });
                videoElement.srcObject = cameraStream;
                videoElement.play();

                videoElement.addEventListener('loadeddata', () => {
                    canvas.width = videoElement.videoWidth;
                    canvas.height = videoElement.videoHeight;
                    // D√©marrer la boucle d'analyse de l'image
                    isCameraActive = true;
                    updateCameraUI(true);
                    morseSequence = '';
                    lastLightState = false;
                    lastEventTime = Date.now();
                    analysisLoop = requestAnimationFrame(analyzeFrame);
                    showToast("Analyse Morse par cam√©ra D√âMARR√âE.");
                }, { once: true });

            } catch (err) {
                console.error("Erreur d'acc√®s √† la cam√©ra:", err);
                showToast("Erreur: Acc√®s √† la cam√©ra refus√© ou impossible. V√©rifiez les autorisations.");
            }
        }

        function stopCameraAnalysis() {
            if (!isCameraActive) return;

            if (cameraStream) {
                cameraStream.getTracks().forEach(track => track.stop());
                cameraStream = null;
            }
            cancelAnimationFrame(analysisLoop);
            isCameraActive = false;
            updateCameraUI(false);
            showToast("Analyse Morse par cam√©ra ARR√äT√âE.");
        }

        function analyzeFrame() {
            if (!isCameraActive) return;

            // 2. Dessiner la frame sur le canvas
            ctx.drawImage(videoElement, 0, 0, canvas.width, canvas.height);

            // 3. Lire les donn√©es de pixels pour la luminosit√© (zone centrale)
            const regionSize = 20; // Analyse d'un carr√© de 20x20 pixels au centre
            const centerX = Math.floor(canvas.width / 2);
            const centerY = Math.floor(canvas.height / 2);

            try {
                const imageData = ctx.getImageData(centerX - regionSize/2, centerY - regionSize/2, regionSize, regionSize).data;
                let totalBrightness = 0;
                // Calculer la luminosit√© moyenne (Luma approximatif)
                for (let i = 0; i < imageData.length; i += 4) {
                    // Luma Y = 0.299*R + 0.587*G + 0.114*B (approx)
                    totalBrightness += (imageData[i] * 0.299 + imageData[i + 1] * 0.587 + imageData[i + 2] * 0.114);
                }
                const pixelCount = (imageData.length / 4);
                const averageBrightness = totalBrightness / pixelCount;

                // 4. D√©terminer l'√©tat du flash
                const currentLightState = averageBrightness > BRIGHTNESS_THRESHOLD;

                const currentTime = Date.now();
                const duration = currentTime - lastEventTime;

                if (currentLightState !== lastLightState) {
                    
                    if (lastLightState) {
                        // Light ON -> Light OFF (Fin d'un Point ou Trait)
                        processFlashDuration(duration);
                    } else {
                        // Light OFF -> Light ON (Fin d'une Pause)
                        processSpaceDuration(duration);
                    }

                    lastLightState = currentLightState;
                    lastEventTime = currentTime;
                }
                
            } catch (e) {
                console.warn("Erreur d'analyse d'image (probablement hors-champ)", e);
            }

            analysisLoop = requestAnimationFrame(analyzeFrame);
        }

        function processFlashDuration(duration) {
            // Mise √† jour de l'estimation de l'unit√© de temps bas√©e sur la dur√©e moyenne de tous les points/traits
            const dotDuration = unitDurationEstimate;
            const dashDuration = unitDurationEstimate * 3;

            // D√©terminer si c'est un point ou un trait
            // Utiliser une marge de 50%
            if (duration >= dotDuration * 0.5 && duration < dashDuration * 1.5) {
                
                let morseSymbol;
                if (duration < dotDuration * 1.5) {
                    morseSymbol = '.'; // Point
                    // Auto-calibration : Tente de se rapprocher de la dur√©e du point
                    unitDurationEstimate = (unitDurationEstimate * 9 + duration) / 10;
                } else {
                    morseSymbol = '-'; // Trait
                    // Auto-calibration : Tente de se rapprocher de la dur√©e du Trait / 3
                    unitDurationEstimate = (unitDurationEstimate * 9 + duration / 3) / 10;
                }
                
                morseSequence += morseSymbol;
                unitDurationEstimate = Math.max(1200 / MAX_WPM_FOR_CALIBRATION, Math.min(1200 / MIN_WPM_FOR_CALIBRATION, unitDurationEstimate)); // Garde l'estimation dans une plage raisonnable (5-40 WPM)
                unitDurationDisplay.textContent = Math.round(unitDurationEstimate);

                // Mettre √† jour la s√©quence
                outputText.value = morseSequence;
                convertToText();

            } else {
                // Flash ignor√© (erreur de d√©tection)
                // morseSequence += "[Flash-Err]";
            }
        }

        function processSpaceDuration(duration) {
            const unitTime = unitDurationEstimate;
            let spaceSymbol = '';
            
            // Pauses : 1T (entre symboles), 3T (entre lettres), 7T (entre mots)
            
            if (duration >= unitTime * 1.5 && duration < unitTime * 4) {
                // Pause entre lettres (~3 unit√©s)
                spaceSymbol = ' ';
            } else if (duration >= unitTime * 4) {
                // Pause entre mots (>= 7 unit√©s)
                spaceSymbol = ' / ';
            } else if (duration >= unitTime * 0.5) {
                 // Pause entre signaux (~1 unit√©) - Rien √† ajouter au Morse
                 return;
            }

            // Ajouter le s√©parateur et nettoyer si n√©cessaire
            if (spaceSymbol && !morseSequence.endsWith(spaceSymbol.trim())) {
                morseSequence += spaceSymbol;
                outputText.value = morseSequence;
                convertToText();
            }
        }
        
        // --- UI HELPERS ---
        function toggleSignal(on, type = null) {
            // 1. Bulb (Internal UI indicator)
            if (on) {
                signalBulb.classList.add('signal-active');
                bulbIcon.classList.add('fa-beat');
            } else {
                signalBulb.classList.remove('signal-active');
                bulbIcon.classList.remove('fa-beat');
            }

            // 2. Body Flash (Full-screen effect, only if enabled)
            if (isFlashEnabled) {
                if (on) {
                    document.body.classList.add('flash-active');
                } else {
                    setTimeout(() => document.body.classList.remove('flash-active'), 50);
                }
            }
        }

        function updatePlayUI(playing) {
            const playBtn = document.getElementById('playBtn');
            const stopBtn = document.getElementById('stopBtn');
            
            if (playing) {
                playBtn.classList.add('hidden');
                stopBtn.classList.remove('hidden');
                playingStatusDisplay.textContent = "TRANSMISSION EN COURS...";
                playingStatusDisplay.classList.add('text-red-400', 'animate-pulse');
                
                inputText.disabled = true;
                outputText.disabled = true;
                flashToggleBtn.disabled = true;
                wpmInput.disabled = true;
                cameraStartBtn.disabled = true; // D√©sactiver la cam√©ra pendant la lecture
            } else {
                playBtn.classList.remove('hidden');
                stopBtn.classList.add('hidden');
                playingStatusDisplay.textContent = "PR√äT";
                playingStatusDisplay.classList.remove('text-red-400', 'animate-pulse');
                
                inputText.disabled = false;
                outputText.disabled = false;
                flashToggleBtn.disabled = false;
                wpmInput.disabled = false;
                cameraStartBtn.disabled = false;
            }
        }

        function updateCameraUI(active) {
            if (active) {
                cameraStartBtn.classList.add('hidden');
                cameraStopBtn.classList.remove('hidden');
                playingStatusDisplay.textContent = "√âCOUTE OPTIQUE EN COURS...";
                playingStatusDisplay.classList.add('text-emerald-400', 'animate-pulse');

                // D√©sactivation des inputs
                inputText.disabled = true;
                document.getElementById('playBtn').disabled = true;
                
            } else {
                cameraStartBtn.classList.remove('hidden');
                cameraStopBtn.classList.add('hidden');
                if (!isPlaying) {
                    playingStatusDisplay.textContent = "PR√äT";
                    playingStatusDisplay.classList.remove('text-emerald-400', 'animate-pulse');
                }
                
                // R√©activation des inputs
                inputText.disabled = false;
                document.getElementById('playBtn').disabled = false;
            }
        }
        
        function toggleFlashlightMode() {
            isFlashEnabled = !isFlashEnabled;
            
            if (isFlashEnabled) {
                flashToggleBtn.classList.remove('bg-[#30363d]', 'hover:bg-[#484f58]');
                flashToggleBtn.classList.add('bg-cyan-600', 'hover:bg-cyan-500');
                flashStatusDisplay.textContent = "ON";
                showToast("Lampe Torche √âcran : ON");
            } else {
                flashToggleBtn.classList.add('bg-[#30363d]', 'hover:bg-[#484f58]');
                flashToggleBtn.classList.remove('bg-cyan-600', 'hover:bg-cyan-500');
                flashStatusDisplay.textContent = "OFF";
                document.body.classList.remove('flash-active');
                showToast("Lampe Torche √âcran : OFF");
            }
        }

        function clearInput(id) {
            document.getElementById(id).value = '';
            if(id === 'inputText') outputText.value = '';
            if(id === 'outputText') inputText.value = '';
            morseSequence = '';
            showToast('Champ effac√©');
        }

        function copyToClipboard(id, message) {
            const copyText = document.getElementById(id);
            copyText.select();
            copyText.setSelectionRange(0, 99999);
            document.execCommand('copy');
            showToast(message);
            
            if (window.getSelection) {window.getSelection().removeAllRanges();}
        }
        
        async function pasteText() {
            try {
                const text = await navigator.clipboard.readText();
                inputText.value = text;
                convertToMorse();
                showToast("Texte coll√© et traduit");
            } catch (err) {
                showToast("Erreur lors de l'acc√®s au presse-papiers.");
            }
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            const msg = document.getElementById('toast-msg');
            msg.innerText = message;
            toast.classList.remove('translate-y-20', 'opacity-0');
            toast.classList.add('translate-y-0', 'opacity-100');
            setTimeout(() => {
                toast.classList.remove('translate-y-0', 'opacity-100');
                toast.classList.add('translate-y-20', 'opacity-0');
            }, 2500);
        }

        // --- CHEAT SHEET GENERATION ---
        function toggleCheatSheet() {
            const sheet = document.getElementById('cheatSheet');
            const chevron = document.getElementById('chevron');
            sheet.classList.toggle('hidden');
            if (sheet.classList.contains('hidden')) {
                chevron.classList.remove('rotate-180');
            } else {
                chevron.classList.add('rotate-180');
            }
        }

        function initCheatSheet() {
            const grid = document.getElementById('dictionary-grid');
            Object.entries(MORSE_CODE).forEach(([char, code]) => {
                const div = document.createElement('div');
                div.className = "flex flex-col items-center justify-center bg-[#161b22] p-2.5 rounded-lg border border-[#30363d] hover:bg-[#1f2730] transition-all cursor-pointer flash-invert-bg";
                
                let displayChar = char === ' ' ? 'ESPACE' : char;

                div.innerHTML = `
                    <span class="text-cyan-400 font-bold text-lg">${displayChar}</span> 
                    <span class="text-emerald-400 text-sm tracking-widest mt-1">${code}</span>
                `;
                div.onclick = () => {
                    inputText.value += char;
                    convertToMorse();
                };
                grid.appendChild(div);
            });
        }
    </script>
</body>
</html>
‚öôÔ∏è Points Cl√©s de l'Int√©gration de la Cam√©ra
Nouveaux √©l√©ments HTML : J'ai ajout√© <video id="videoElement" autoplay muted style="display: none;"></video> et <canvas id="analysisCanvas" style="display: none;"></canvas> pour le flux vid√©o et son analyse. Ils sont masqu√©s.

Boutons de Contr√¥le : J'ai ins√©r√© des boutons D√©marrer Cam√©ra / Arr√™ter Cam√©ra dans la grille des commandes.

Fonction startCameraAnalysis() :

Demande l'acc√®s √† la cam√©ra de l'utilisateur.

Tente d'utiliser la facingMode: "environment" pour privil√©gier la cam√©ra arri√®re (plus stable).

D√©marre la boucle d'analyse requestAnimationFrame(analyzeFrame).

Fonction analyzeFrame() :

Capture l'image de la vid√©o sur le canvas.

Calcule la luminosit√© moyenne dans un petit carr√© central de l'image.

Compare cette luminosit√© √† un seuil (BRIGHTNESS_THRESHOLD = 150) pour d√©terminer si le flash est ON ou OFF.

Appelle processFlashDuration() ou processSpaceDuration() lors d'un changement d'√©tat (ON ou OFF).

Auto-Calibration : Les fonctions processFlashDuration() et processSpaceDuration() tentent d'estimer et d'ajuster l'unitDurationEstimate (dur√©e d'un point en millisecondes) bas√©e sur les flashs courts d√©tect√©s. C'est crucial pour traduire des signaux Morse de vitesses variables.

Vous avez atteint votre limite pour le mode Thinking
Les r√©ponses utiliseront d'autres mod√®les jusqu'√† ce que la limite soit r√©initialis√©e, le 7 d√©c., 18:21. Passez √† une version sup√©rieure pour b√©n√©ficier de limites plus √©lev√©es et d'autres avantages.



V√©rifiez les r√©ponses de Gemini, car il peut se tromper, y compris sur des personnes. Votre confidentialit√© et GeminiS'ouvre dans une nouvelle fen√™tre

