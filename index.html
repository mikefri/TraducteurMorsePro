<!DOCTYPE html>
<html lang="fr" class="theme-light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>TraducteurMorsePro</title>
    <link rel="manifest" href="./manifest.json">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body class="flex flex-col items-center p-4 md:p-10">
    <button id="themeToggleBtn" onclick="toggleTheme()" class="absolute top-4 left-4 p-3 rounded-full shadow-lg cursor-pointer z-10" title="Basculer le thème (Clair/Sombre)">
        <i class="fa-solid text-xl" id="themeIcon"></i>
    </button>

    <header class="w-full max-w-6xl mb-10 md:mb-12">
        <div class="flex items-center justify-center space-x-2">
            <h1 class="text-3xl md:text-5xl font-extrabold tracking-tighter text-[var(--color-text-dark)]">TRADUCTEUR</h1>
            <h1 class="text-3xl md:text-5xl font-extrabold tracking-tighter text-[var(--color-accent-cyan)] border-b-4 border-[var(--color-accent-cyan)] pb-1">MORSE</h1>
        </div>
        <p class="text-center text-sm text-[var(--color-text-subtle)] mt-2 mono-code">CONVERTISSEUR ANALOGIQUE-NUMÉRIQUE</p>
    </header>

    <div class="flex flex-col items-center mb-6 md:mb-8">
        <div id="signal-bulb" class="flex items-center justify-center cursor-pointer" title="Indicateur Visuel">
            <i class="fa-solid fa-satellite-dish text-3xl text-[var(--color-text-subtle)] transition-colors" id="bulb-icon"></i>
        </div>
        <div class="text-sm font-bold mt-2 tracking-widest" id="playing-status">PRÊT</div>
    </div>

    <div class="flex mb-6 md:mb-8 p-1 rounded-xl border border-[var(--color-border)] shadow-md bg-[var(--color-card-bg)] w-full max-w-sm">
        <button id="mode-text-to-morse" class="mode-button flex-1 px-4 py-2 rounded-lg text-sm font-semibold transition-colors mode-toggle-active" onclick="setMode('textToMorse')">
            Texte → Morse
        </button>
        <button id="mode-morse-to-text" class="mode-button flex-1 px-4 py-2 rounded-lg text-sm font-semibold text-[var(--color-text-subtle)] hover:bg-[var(--color-gray-50)] transition-colors" onclick="setMode('morseToText')">
            Morse → Texte
        </button>
    </div>

    <main class="w-full max-w-6xl grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6 relative mb-6 md:mb-8">

        <div class="flex flex-col h-[300px] md:h-[350px] code-container rounded-xl overflow-hidden">
            <div class="flex justify-between items-center p-4 container-header">
                <label id="inputLabel" class="text-xs font-bold uppercase text-[var(--color-text-subtle)] tracking-wider">ENTRÉE TEXTE</label>
                <button onclick="clearInput('inputText')" class="text-[var(--color-text-subtle)] hover:text-red-500 text-sm transition-colors" title="Effacer">
                    <i class="fa-solid fa-eraser"></i>
                </button>
            </div>
            <textarea 
                id="inputText" 
                placeholder="Commencez à taper..." 
                class="w-full flex-grow p-4 outline-none resize-none mono-code text-lg placeholder-[var(--color-text-subtle)] border-0 focus:ring-0"
                oninput="handleInput()"
            ></textarea>
        </div>

        <div class="flex flex-col h-[300px] md:h-[350px] code-container rounded-xl overflow-hidden">
            <div class="flex justify-between items-center p-4 container-header">
                <label id="outputLabel" class="text-xs font-bold uppercase text-[var(--color-text-subtle)] tracking-wider">SORTIE CODE MORSE</label>
                <button onclick="copyToClipboard('outputText', 'Code Copié !')" class="text-[var(--color-accent-cyan)] hover:opacity-75 text-sm transition-colors" title="Copier">
                    <i class="fa-solid fa-copy"></i>
                </button>
            </div>
            <textarea 
                id="outputText" 
                placeholder="Résultat de la conversion..." 
                class="w-full flex-grow p-4 outline-none resize-none mono-code text-lg md:text-xl text-[var(--color-accent-cyan)] placeholder-[var(--color-text-subtle)] border-0 focus:ring-0 leading-relaxed"
                readonly
            ></textarea>
        </div>
    </main>
    
    <div class="w-full max-w-6xl p-4 bg-[var(--color-card-bg)] rounded-xl shadow-lg border border-[var(--color-border)] mb-6 md:mb-8">

        <div class="flex flex-col md:flex-row justify-between items-center pb-4 mb-4 border-b border-[var(--color-border)] space-y-4 md:space-y-0">
            <div class="flex items-center space-x-2 md:space-x-4 w-full md:w-1/2">
                <label for="wpm" class="text-xs font-bold text-[var(--color-text-subtle)] whitespace-nowrap">WPM (<span id="wpmValue">20</span>):</label> 
                <input type="range" id="wpm" min="5" max="40" value="20" class="w-full h-2 accent-[var(--color-accent-cyan)] cursor-pointer rounded-lg bg-[var(--color-border)]">
             </div>

            <div class="flex space-x-3 w-full md:w-auto justify-center md:justify-start">
                 <button id="muteToggleBtn" onclick="toggleMute()" class="btn-action bg-[var(--color-gray-50)] hover:bg-[var(--color-border)] text-[var(--color-text-subtle)] flex items-center space-x-2">
                     <i class="fa-solid fa-volume-high text-lg" id="muteIcon"></i>
                     <span class="hidden md:inline">Muet</span> </button>

                 <button id="flashToggleBtn" onclick="toggleFlashlightMode()" class="btn-action bg-[var(--color-gray-50)] hover:bg-[var(--color-border)] text-[var(--color-text-subtle)] flex items-center space-x-2">
                     <i class="fa-solid fa-mobile-screen-button text-lg" id="flashIcon"></i>
                     <span class="hidden md:inline">Flash</span> </button>
             </div>
        </div>

        <div class="flex justify-between items-center">
            
            <div class="flex space-x-3">
                <button id="playBtn" onclick="togglePlayStop('play')" class="btn-action bg-[var(--color-cta-green)] hover:opacity-90 text-white flex items-center space-x-2">
                    <i class="fa-solid fa-play text-lg"></i>
                    <span class="hidden sm:inline">JOUER SIGNAL</span>
                    <span class="sm:hidden">JOUER</span>
                </button>
                <button id="stopBtn" onclick="togglePlayStop('stop')" class="btn-action bg-red-500 hover:opacity-90 text-white flex items-center space-x-2 hidden">
                    <i class="fa-solid fa-stop text-lg"></i>
                    <span class="hidden sm:inline">ARRÊTER</span>
                    <span class="sm:hidden">STOP</span>
                </button>
            </div>

            <button id="loopToggleBtn" onclick="toggleLoop()" class="btn-action bg-[var(--color-gray-50)] hover:bg-[var(--color-border)] text-[var(--color-text-subtle)] flex items-center space-x-2">
                <i class="fa-solid fa-sync text-lg" id="loopIcon"></i>
                <span id="loopStatus" class="font-bold hidden sm:inline">BOUCLE OFF</span>
                <span class="sm:hidden">BOUCLE</span>
            </button>
            
            </div>
    </div>
    
    <div class="w-full max-w-6xl mt-4 border border-[var(--color-border)] rounded-xl overflow-hidden shadow-lg">
        <button onclick="toggleDictionary()" class="w-full flex justify-between items-center p-4 bg-[var(--color-card-bg)] hover:bg-[var(--color-gray-50)] transition-colors cursor-pointer">
            <h2 class="text-base md:text-xl font-bold uppercase tracking-wider text-[var(--color-text-dark)]">RÉFÉRENCE DU CODE MORSE</h2>
            <i class="fa-solid fa-chevron-up text-[var(--color-accent-cyan)] text-lg" id="toggle-icon"></i>
        </button>

        <div id="morseDictionaryContainer" class="max-h-0 overflow-hidden transition-all duration-300 ease-in-out">
            <div id="morseDictionary" class="dictionary-table">
                </div>
        </div>
    </div>

    <div id="toast" class="fixed bottom-5 right-5 bg-[var(--color-accent-cyan)] text-white px-6 py-3 rounded-xl shadow-2xl transform translate-y-20 opacity-0 transition-all duration-300 z-50 flex items-center gap-3">
        <i class="fa-solid fa-circle-check text-xl"></i>
        <span id="toast-msg" class="font-medium">Opération réussie</span>
    </div>

    <script src="script.js"></script>
</body>
</html>
